
# R-INN 论文复现项目 README

## 最新进展

### 滤波器理想幅频特性生成工具
- **文件**: `filter_ideal_figure.py`
- **功能**: 生成满足特定性能要求的四阶波导滤波器理想幅频特性曲线
- **输出目录**: `result_RINN_input`
- **工作意义**: 为R-INN模型提供高质量的输入数据，确保模型训练和推理时有准确的目标性能曲线

### 原有进展
该分支的最新进展在trains11RINN_SParameter.py中,该文件有详细的开头注释.

实验结果在model_checkpoints_rinn/rinn_sparameter_20260129_172545中.

该分支的主旨思想: 曾经为5维几何参数,预测101维的性能图,横轴为频率f.经过老师的意见,我们决定改为202维的性能图,即不使用幅值,而是实部和虚部,并且将原先的横轴f,拼接在5维几何参数后侧,最后的模型形状即为左侧5(几何参数)+1(频率f)+2(零填充),右侧2(实数和虚数)+6(latent变量Z).

### 最佳模型性能
- **最佳Epoch**: 114
- **最佳验证集损失**: 0.005976
- **验证集Y损失**: 0.000951
- **验证集Y NMSE**: 0.001033
- **验证集X损失**: 0.000060
- **验证集Z损失**: 0.015064

​
## 项目概述​
本仓库用于复现论文《R-INN: An Efficient Reversible Design Model for Microwave Circuit Design》中的可逆神经网络（Real NVP-based Invertible Neural Network）模型。该模型将可逆神经网络应用于微波电路设计，通过学习电路参数与电磁响应之间的映射关系，实现高效的电路设计与优化。​
复现目标包括：​
实现论文提出的 R-INN 网络结构​
复现关键实验结果（如 NMSE 误差、S 参数拟合曲线）​
建立可复用的微波电路设计深度学习工作流

## 滤波器理想幅频特性生成工具

### 功能说明
`filter_ideal_figure.py` 是一个专门用于生成微波滤波器理想幅频特性曲线的工具，主要功能包括：

1. **四阶波导滤波器设计**: 严格按照四阶波导滤波器的特性生成理想幅频响应
2. **性能参数优化**: 通过搜索最佳的通带波纹参数（RP），确保生成的曲线满足用户指定的性能要求
3. **S参数计算**: 同时计算S11的幅值、实部和虚部，为R-INN模型提供完整的输入数据
4. **数据验证**: 验证生成的曲线是否全部满足用户指定的性能要求
5. **可视化输出**: 生成直观的幅频特性曲线和S参数实部/虚部曲线

### 使用方法

#### 基本用法
```bash
python filter_ideal_figure.py
```

#### 参数配置
在 `filter_ideal_figure.py` 文件中，用户可以根据需要修改以下参数：

1. **固定参数**:
   - `fs = 40e9`: 采样率（30GHz）
   - `order = 4`: 滤波器阶数（固定为四阶）
   - `n_points = 2048`: RINN输入频率分辨率
   - `f_start = 9.0e9`: 起始频率
   - `f_stop = 12.0e9`: 终止频率

2. **性能需求配置**:
   在 `filter_configs` 列表中，可以添加或修改滤波器的性能需求：
   ```python
   filter_configs = [
       {
           'name': 'X_band_4th_order',
           'f_low': 10.85e9,         # 通带起始频率
           'f_high': 11.15e9,        # 通带结束频率
           's11_target': -26,        # 通带S11全部 ≤ 该值
           'description': '4th-order Waveguide BPF |S11 ≤ -20dB (10.85-11.15GHz)'
       }
   ]
   ```

3. **RP参数搜索配置**:
   ```python
   rp_min = 0.001     # RP最小值
   rp_max = 5.00      # RP最大值
   rp_step = 0.01     # RP步长
   ```

### 输出结果

运行 `filter_ideal_figure.py` 后，会在 `result_RINN_input` 目录中生成以下文件：

1. **图像文件**:
   - `Waveguide_4th_S11_under_{target_dB}dB.png`: 滤波器的幅频特性曲线
   - `Waveguide_4th_S11_real_imag_{target_dB}dB.png`: S11实部和虚部曲线

2. **数据文件**:
   - `RINN_input_freq_S11.npz`: 包含频率、S11 dB值、实部、虚部等完整数据
   - `RP_search_results.npz`: RP参数搜索的详细结果

### 工作意义

1. **提供高质量训练数据**: 为R-INN模型提供准确、符合实际的目标性能曲线，提高模型训练效果
2. **性能参数优化**: 通过搜索最佳RP参数，确保生成的曲线满足特定的性能要求
3. **完整S参数计算**: 同时提供S11的幅值、实部和虚部，为R-INN模型提供全面的输入信息
4. **可视化验证**: 通过生成直观的曲线，方便用户验证生成的结果是否符合要求
5. **标准化流程**: 建立了从性能需求到理想曲线生成的标准化流程，提高了工作效率

## 环境配置&项目页面


<sup> https://www.notion.so/276a5242543380d38f58f1346d75a53d?source=copy_link </sup>

<sup> https://www.notion.so/R-INN-271a52425433805790a7c71d2da181dd </sup>
