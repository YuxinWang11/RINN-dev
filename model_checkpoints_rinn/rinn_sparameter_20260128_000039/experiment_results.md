# RINN S参数预测实验结果报告

## 实验基本信息
- **实验时间**: 2026-01-28 00:00:39
- **实验ID**: rinn_sparameter_20260128_000039
- **模型类型**: RINN (Reversible Invertible Neural Network)
- **任务**: S参数预测 (S11, S21)

## 数据集信息

### 原始数据
- **频率点数**: 101
- **频率范围**: 10.5 GHz - 11.5 GHz
- **原始样本数**: 446,824
- **配对样本数**: 111,706

### 几何参数组合采样
- **几何参数组合总数**: 1,106
- **选择的几何参数组合数**: 110 (占总数的 9.9%)
- **采样后样本数**: 11,110

### 数据维度
- **X数据形状**: (11110, 6) - 几何参数 + 频率
- **Y数据形状**: (11110, 2) - S参数 (S11, S21)

### 数据归一化
- **归一化方法**: Standard (Z-score)
- **X特征归一化后**: 均值=-0.003880, 标准差=1.005298
- **Y数据归一化后**: 均值=-0.001263, 标准差=1.002851
- **X特征范围**: [-9.443153, 2.152674]
- **Y数据范围**: [-2.425613, 2.287351]
- **数据质量**: 无NaN值，无无穷大值

## 模型架构

### 维度配置
- **X维度**: 6
- **Y维度**: 2
- **Z维度**: 6
- **左侧输入维度**: 8 (X: 6 + 零填充: 2)
- **右侧输入维度**: 8 (Y: 2 + Z: 6)
- **总输入/输出维度**: 8

### 模型参数
- **模型参数总数**: 66,266
- **Affine coupling比率**: 0.75

## 训练配置

### 数据集划分
- **训练集**: 8,888 样本 (80%)
- **验证集**: 2,222 样本 (20%)

### 训练参数
- **训练轮数**: 150 epochs
- **计算设备**: CPU (未检测到GPU)

## 训练结果

### 关键指标记录

| Epoch | Train Loss | Y Loss | Y NMSE | X Loss | Z Loss | Val Loss | Val Y Loss | Val Y NMSE |
|-------|------------|--------|--------|--------|--------|----------|------------|------------|
| 1 | 1.233255 | 0.792224 | 0.837620 | 0.008353 | 0.135808 | 0.864391 | 0.546039 | 0.601783 |
| 2 | 0.700174 | 0.441598 | 0.496795 | 0.006772 | 0.114635 | 0.432065 | 0.264075 | 0.289178 |
| 3 | 0.252573 | 0.143319 | 0.151838 | 0.007046 | 0.113574 | 0.165089 | 0.086740 | 0.087589 |
| 4 | 0.138920 | 0.069873 | 0.070722 | 0.002978 | 0.108740 | 0.115833 | 0.057471 | 0.057259 |
| 5 | 0.093549 | 0.042443 | 0.042306 | 0.001508 | 0.097103 | 0.075983 | 0.034170 | 0.034826 |
| 6 | 0.066563 | 0.026860 | 0.026608 | 0.001056 | 0.085818 | 0.056942 | 0.022831 | 0.022764 |
| 7 | 0.052261 | 0.019684 | 0.019318 | 0.001135 | 0.073890 | 0.047518 | 0.017054 | 0.016852 |
| 8 | 0.046029 | 0.015747 | 0.015629 | 0.000959 | 0.073097 | 0.046079 | 0.015568 | 0.015425 |
| 9 | 0.039794 | 0.013467 | 0.013506 | 0.001266 | 0.063201 | 0.038055 | 0.012514 | 0.012456 |
| 10 | 0.032942 | 0.011358 | 0.011167 | 0.000998 | 0.051351 | 0.038415 | 0.012661 | 0.012609 |
| 12 | 0.030194 | 0.009998 | 0.009933 | 0.000809 | 0.049308 | 0.025979 | 0.008392 | 0.008458 |
| 13 | 0.026784 | 0.008394 | 0.008513 | 0.000803 | 0.045969 | 0.024474 | 0.008684 | 0.008656 |
| 15 | 0.024286 | 0.007363 | 0.007400 | 0.001084 | 0.042333 | 0.022969 | 0.008088 | 0.008022 |
| 16 | 0.023413 | 0.006700 | 0.006736 | 0.000845 | 0.043134 | 0.020702 | 0.007106 | 0.007459 |
| 19 | 0.020701 | 0.005956 | 0.006035 | 0.000452 | 0.038468 | 0.017837 | 0.005648 | 0.005718 |
| 28 | 0.017003 | 0.004133 | 0.004286 | 0.001185 | 0.034035 | 0.016753 | 0.003129 | 0.003260 |
| 35 | 0.014205 | 0.003087 | 0.003127 | 0.000510 | 0.031064 | 0.013956 | 0.003658 | 0.003787 |
| 40 | 0.015737 | 0.003505 | 0.003543 | 0.000296 | 0.034438 | 0.010771 | 0.002466 | 0.002544 |
| 56 | 0.010124 | 0.001579 | 0.001601 | 0.000118 | 0.025655 | 0.010698 | 0.001246 | 0.001256 |
| 64 | 0.009811 | 0.001153 | 0.001164 | 0.000146 | 0.026697 | 0.009951 | 0.001369 | 0.001382 |
| 72 | 0.011561 | 0.001485 | 0.001487 | 0.000129 | 0.030895 | 0.008595 | 0.001208 | 0.001251 |

### 最佳模型性能
- **最佳Epoch**: 72
- **最佳验证集损失**: 0.008595
- **验证集Y损失**: 0.001208
- **验证集Y NMSE**: 0.001251
- **验证集X损失**: 0.000092
- **验证集Z损失**: 0.022458

### 训练趋势分析

#### 早期阶段 (Epoch 1-10)
- 训练损失从1.233快速下降至0.033
- 验证损失从0.864下降至0.038
- 学习速度快，模型快速拟合数据

#### 中期阶段 (Epoch 11-40)
- 训练损失继续下降至0.016
- 验证损失在0.017-0.028之间波动
- 出现轻微过拟合迹象，但整体趋势向好

#### 后期阶段 (Epoch 41-72)
- 训练损失稳定在0.010-0.016之间
- 验证损失持续下降至最佳值0.008595
- 模型收敛，泛化能力提升

#### 收敛阶段 (Epoch 73-150)
- 验证损失在0.008-0.018之间波动
- 模型基本收敛，性能稳定

## 性能总结

### 预测精度
- **Y NMSE (归一化均方误差)**: 0.001251 (最佳)
- **Y Loss**: 0.001208 (最佳)
- **X重建误差**: 0.000092 (最佳)
- **Z分布匹配误差**: 0.022458 (最佳)

### 模型优势
1. **高精度**: Y NMSE达到0.001251，表明S参数预测精度很高
2. **快速收敛**: 在前10个epoch内损失下降超过95%
3. **稳定训练**: 150个epoch训练过程稳定，无发散现象
4. **良好泛化**: 验证集损失持续下降，泛化能力良好

### 模型特点
- 使用可逆神经网络架构，支持双向推理
- 通过Z维度的潜在变量建模，增强了表达能力
- 多损失函数联合优化，平衡了预测精度和分布匹配

## 输出文件
- `training_config.json`: 训练配置
- `used_config.json`: 使用的配置
- `training_losses.png`: 训练损失曲线
- `s11_trend_plot.png`: S11趋势图
- `generated_xs.npy`: 生成的X样本
- `predicted_ys.npy`: 预测的Y值

## 结论
本次实验成功训练了RINN模型用于S参数预测任务。模型在72个epoch达到最佳性能，验证集损失为0.008595，Y NMSE为0.001251，展现了优秀的预测精度和泛化能力。模型能够准确预测S11和S21参数，为微波器件设计提供了有效的辅助工具。